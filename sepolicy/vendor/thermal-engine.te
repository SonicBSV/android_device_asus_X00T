type_transition thermal-engine system_data_file:file decrypt_file "decrypt.txt";
allow thermal-engine default_prop:file { getattr open read };
allow thermal-engine system_prop:file { getattr open read };
allow thermal-engine system_prop:property_service set;
allow thermal-engine init:unix_stream_socket connectto;
allow thermal-engine property_socket:sock_file write;
allow thermal-engine system_data_file:dir w_dir_perms;
allow thermal-engine self:capability { chown fowner };
allow thermal-engine decrypt_file:file create_file_perms;
allow thermal-engine thermal_data_file:dir rw_dir_perms;
allow thermal-engine thermal_data_file:file create_file_perms;
allow thermal-engine sysfs:dir r_dir_perms;
allow thermal-engine { proc_stat proc_loadavg }:file r_file_perms;
dontaudit thermal-engine self:capability dac_override;
#set_prop(thermal-engine, thermal_prop);
r_dir_file(thermal-engine, sysfs)
r_dir_file(thermal-engine, sysfs_batteryinfo)
r_dir_file(thermal-engine sysfs_devfreq)
r_dir_file(thermal-engine sysfs_graphics)
r_dir_file(thermal-engine sysfs_thermal)
r_dir_file(thermal-engine sysfs_hwmon)
r_dir_file(thermal-engine sysfs_socinfo)
